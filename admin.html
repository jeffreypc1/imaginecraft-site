<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>Admin Dashboard - ImagineCraft Studios</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=VT323&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #1F1F1F;
            --background: #FAFAF7;
            --accent: #5B5FEA;
            --glass: rgba(255, 255, 255, 0.1);
            --charcoal: var(--primary);
            --off-white: var(--background);
            --charcoal-light: #2a2a2a;
            --off-white-dark: #e8e8e5;
            --success: #22c55e;
            --error: #ef4444;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Inter', system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
            background-color: var(--background);
            color: var(--primary);
            line-height: 1.6;
            min-height: 100vh;
        }

        /* Header */
        .header {
            background-color: var(--charcoal);
            color: var(--off-white);
            padding: 1.5rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 1.25rem;
            font-weight: 600;
            letter-spacing: -0.02em;
        }

        .nav-links {
            display: flex;
            list-style: none;
            gap: 2rem;
        }

        .nav-links a {
            text-decoration: none;
            color: var(--off-white);
            font-size: 0.95rem;
            font-weight: 400;
            opacity: 0.8;
            transition: opacity 0.2s ease;
        }

        .nav-links a:hover {
            opacity: 1;
        }

        /* Login Section */
        .login-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: calc(100vh - 76px);
            padding: 2rem;
            background-color: var(--charcoal);
        }

        .login-card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 24px;
            padding: 3rem;
            width: 100%;
            max-width: 400px;
        }

        .login-card h1 {
            color: var(--off-white);
            font-size: 1.75rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            text-align: center;
        }

        .login-card p {
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.95rem;
            margin-bottom: 2rem;
            text-align: center;
        }

        /* Form Styles */
        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            font-size: 0.9rem;
            font-weight: 500;
            margin-bottom: 0.5rem;
            color: var(--off-white);
            opacity: 0.9;
        }

        .form-group input,
        .form-group textarea {
            width: 100%;
            padding: 1rem;
            font-family: 'Inter', system-ui, sans-serif;
            font-size: 1rem;
            color: var(--off-white);
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.15);
            border-radius: 8px;
            outline: none;
            transition: border-color 0.2s ease, background-color 0.2s ease;
        }

        .form-group input::placeholder,
        .form-group textarea::placeholder {
            color: rgba(255, 255, 255, 0.4);
        }

        .form-group input:focus,
        .form-group textarea:focus {
            border-color: rgba(255, 255, 255, 0.4);
            background: rgba(255, 255, 255, 0.08);
        }

        .btn {
            display: inline-block;
            padding: 1rem 2rem;
            background-color: rgba(255, 255, 255, 0.15);
            color: var(--off-white);
            text-decoration: none;
            font-size: 1rem;
            font-weight: 500;
            border-radius: 4px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            backdrop-filter: blur(10px);
            cursor: pointer;
            transition: transform 0.2s ease, box-shadow 0.2s ease, background-color 0.2s ease;
            width: 100%;
            text-align: center;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
            background-color: rgba(255, 255, 255, 0.25);
        }

        .btn-primary {
            background-color: var(--accent);
            border-color: var(--accent);
        }

        .btn-primary:hover {
            background-color: #4a4ed8;
        }

        .error-message {
            color: var(--error);
            font-size: 0.875rem;
            margin-top: 0.5rem;
            display: none;
        }

        .error-message.visible {
            display: block;
        }

        /* Dashboard Section */
        .dashboard {
            display: none;
            padding: 2rem;
            max-width: 1200px;
            margin: 0 auto;
        }

        .dashboard.visible {
            display: block;
        }

        .dashboard-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }

        .dashboard-header h1 {
            font-size: 2rem;
            font-weight: 600;
            letter-spacing: -0.02em;
        }

        .dashboard-actions {
            display: flex;
            gap: 1rem;
        }

        .dashboard-actions .btn {
            width: auto;
            padding: 0.75rem 1.5rem;
        }

        .btn-success {
            background-color: var(--success);
            border-color: var(--success);
            color: white;
        }

        .btn-success:hover {
            background-color: #16a34a;
        }

        .btn-danger {
            background-color: var(--error);
            border-color: var(--error);
            color: white;
        }

        .btn-danger:hover {
            background-color: #dc2626;
        }

        .btn-primary {
            background-color: var(--primary);
            border-color: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background-color: #3b3fb8;
        }

        /* Hero Text Section */
        .hero-section {
            background: white;
            border: 1px solid var(--off-white-dark);
            border-radius: 16px;
            padding: 1.5rem;
            margin-bottom: 2rem;
        }

        .hero-section h2 {
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--primary);
        }

        .hero-section p {
            font-size: 0.9rem;
            color: rgba(31, 31, 31, 0.6);
            margin-bottom: 1rem;
        }

        .hero-section input {
            width: 100%;
            padding: 0.75rem;
            font-family: 'Inter', system-ui, sans-serif;
            font-size: 1rem;
            color: var(--primary);
            background: var(--background);
            border: 1px solid var(--off-white-dark);
            border-radius: 8px;
            outline: none;
            transition: border-color 0.2s ease, box-shadow 0.2s ease;
        }

        .hero-section input:focus {
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(91, 95, 234, 0.1);
        }

        /* Navigation Links Section */
        .nav-links-section {
            background: white;
            border: 1px solid var(--off-white-dark);
            border-radius: 16px;
            padding: 1.5rem;
            margin-bottom: 2rem;
        }

        .nav-links-section h2 {
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--primary);
        }

        .nav-links-section p {
            font-size: 0.9rem;
            color: rgba(31, 31, 31, 0.6);
            margin-bottom: 1rem;
        }

        .nav-links-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 1rem;
        }

        .nav-links-section .form-group {
            margin-bottom: 0;
        }

        .nav-links-section label {
            display: block;
            font-size: 0.8rem;
            font-weight: 500;
            color: rgba(31, 31, 31, 0.6);
            margin-bottom: 0.5rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .nav-links-section input {
            width: 100%;
            padding: 0.75rem;
            font-family: 'Inter', system-ui, sans-serif;
            font-size: 1rem;
            color: var(--primary);
            background: var(--background);
            border: 1px solid var(--off-white-dark);
            border-radius: 8px;
            outline: none;
            transition: border-color 0.2s ease, box-shadow 0.2s ease;
        }

        .nav-links-section input:focus {
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(91, 95, 234, 0.1);
        }

        /* Thought Cards */
        .thoughts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 1.5rem;
        }

        .thought-card {
            background: white;
            border: 1px solid var(--off-white-dark);
            border-radius: 16px;
            padding: 1.5rem;
            transition: box-shadow 0.2s ease, transform 0.2s ease;
        }

        .thought-card:hover {
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.08);
            transform: translateY(-2px);
        }

        .thought-card .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .thought-card .card-controls {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .thought-card .card-number {
            background: var(--charcoal);
            color: var(--off-white);
            width: 28px;
            height: 28px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.875rem;
            font-weight: 600;
        }

        .thought-card label {
            display: block;
            font-size: 0.8rem;
            font-weight: 500;
            color: rgba(31, 31, 31, 0.6);
            margin-bottom: 0.5rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .thought-card input,
        .thought-card textarea {
            width: 100%;
            padding: 0.75rem;
            font-family: 'Inter', system-ui, sans-serif;
            font-size: 0.95rem;
            color: var(--primary);
            background: var(--background);
            border: 1px solid var(--off-white-dark);
            border-radius: 8px;
            outline: none;
            transition: border-color 0.2s ease, box-shadow 0.2s ease;
        }

        .thought-card input:focus,
        .thought-card textarea:focus {
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(91, 95, 234, 0.1);
        }

        .thought-card textarea {
            min-height: 80px;
            resize: vertical;
        }

        .thought-card .form-group {
            margin-bottom: 1rem;
        }

        .thought-card .form-group:last-child {
            margin-bottom: 0;
        }

        /* Action Type Dropdown */
        .thought-card select {
            width: 100%;
            padding: 0.75rem;
            font-family: 'Inter', system-ui, sans-serif;
            font-size: 0.95rem;
            color: var(--primary);
            background: var(--background);
            border: 1px solid var(--off-white-dark);
            border-radius: 8px;
            outline: none;
            cursor: pointer;
            transition: border-color 0.2s ease, box-shadow 0.2s ease;
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%231F1F1F' d='M6 8L1 3h10z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 0.75rem center;
            padding-right: 2.5rem;
        }

        .thought-card select:focus {
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(91, 95, 234, 0.1);
        }

        /* Conditional Action Fields */
        .action-fields {
            margin-top: 1rem;
            padding: 1rem;
            background: var(--background);
            border-radius: 8px;
            border: 1px dashed var(--off-white-dark);
        }

        .action-fields.hidden {
            display: none;
        }

        .action-fields label {
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .action-fields input,
        .action-fields textarea {
            margin-top: 0.5rem;
        }

        .action-fields textarea {
            font-family: 'Courier New', monospace;
            font-size: 0.85rem;
            min-height: 120px;
            line-height: 1.4;
        }

        /* Toast Notification */
        .toast {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            background: var(--charcoal);
            color: var(--off-white);
            padding: 1rem 1.5rem;
            border-radius: 8px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
            display: flex;
            align-items: center;
            gap: 0.75rem;
            transform: translateY(100px);
            opacity: 0;
            transition: transform 0.3s ease, opacity 0.3s ease;
            z-index: 1000;
        }

        .toast.visible {
            transform: translateY(0);
            opacity: 1;
        }

        .toast.success {
            background: var(--success);
        }

        .toast.error {
            background: var(--error);
        }

        /* Logout button in header */
        .logout-btn {
            background: transparent;
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: var(--off-white);
            padding: 0.5rem 1rem;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: background-color 0.2s ease;
            display: none;
        }

        .logout-btn.visible {
            display: block;
        }

        .logout-btn:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        /* Typing Speed Section */
        .typing-speed-section {
            background: white;
            border: 1px solid var(--off-white-dark);
            border-radius: 16px;
            padding: 1.5rem;
            margin-bottom: 2rem;
        }

        .typing-speed-section h2 {
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--primary);
        }

        .typing-speed-section p {
            font-size: 0.9rem;
            color: rgba(31, 31, 31, 0.6);
            margin-bottom: 1rem;
        }

        .slider-container {
            max-width: 400px;
        }

        .slider-labels {
            display: flex;
            justify-content: space-between;
            font-size: 0.8rem;
            color: rgba(31, 31, 31, 0.6);
            margin-bottom: 0.5rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .speed-slider {
            width: 100%;
            height: 8px;
            border-radius: 4px;
            background: var(--off-white-dark);
            outline: none;
            -webkit-appearance: none;
            appearance: none;
            cursor: pointer;
        }

        .speed-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--accent);
            cursor: pointer;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        .speed-slider::-webkit-slider-thumb:hover {
            transform: scale(1.1);
            box-shadow: 0 0 0 4px rgba(91, 95, 234, 0.2);
        }

        .speed-slider::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--accent);
            cursor: pointer;
            border: none;
        }

        .slider-value {
            margin-top: 0.75rem;
            font-size: 0.9rem;
            color: var(--primary);
        }

        .slider-value span {
            font-weight: 600;
            color: var(--accent);
        }

        /* Toggle Switch */
        .toggle-container {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 52px;
            height: 28px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: var(--off-white-dark);
            transition: 0.3s;
            border-radius: 28px;
        }

        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 22px;
            width: 22px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: 0.3s;
            border-radius: 50%;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .toggle-switch input:checked + .toggle-slider {
            background-color: var(--success);
        }

        .toggle-switch input:checked + .toggle-slider:before {
            transform: translateX(24px);
        }

        .toggle-switch input:focus + .toggle-slider {
            box-shadow: 0 0 0 3px rgba(91, 95, 234, 0.2);
        }

        .toggle-label {
            font-size: 0.95rem;
            font-weight: 500;
            color: var(--primary);
        }

        /* Active Checkbox for Thought Cards */
        .active-toggle-container {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .active-checkbox {
            width: 18px;
            height: 18px;
            cursor: pointer;
            accent-color: var(--success);
        }

        .active-label {
            font-size: 0.9rem;
            font-weight: 500;
            color: var(--primary);
            cursor: pointer;
            user-select: none;
        }

        .thought-card.inactive {
            opacity: 0.6;
            border-color: var(--off-white-dark);
        }

        .thought-card.inactive .card-number {
            background: var(--off-white-dark);
            color: rgba(31, 31, 31, 0.5);
        }

        /* Questions Header Section with Randomize Toggle */
        .questions-header-section {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
            margin-bottom: 1.5rem;
            padding: 1rem 1.5rem;
            background: white;
            border: 1px solid var(--off-white-dark);
            border-radius: 12px;
        }

        .randomize-toggle-container {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .randomize-checkbox {
            width: 20px;
            height: 20px;
            cursor: pointer;
            accent-color: var(--accent);
        }

        .randomize-label {
            font-size: 0.95rem;
            font-weight: 500;
            color: var(--primary);
            cursor: pointer;
            user-select: none;
        }

        .randomize-hint {
            font-size: 0.8rem;
            color: rgba(31, 31, 31, 0.5);
            font-style: italic;
        }

        /* Mood Selector Styles */
        .mood-selector-container {
            max-width: 500px;
        }

        .mood-select {
            width: 100%;
            padding: 0.75rem;
            font-family: 'Inter', system-ui, sans-serif;
            font-size: 0.95rem;
            color: var(--primary);
            background: var(--background);
            border: 1px solid var(--off-white-dark);
            border-radius: 8px;
            outline: none;
            cursor: pointer;
            transition: border-color 0.2s ease, box-shadow 0.2s ease;
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%231F1F1F' d='M6 8L1 3h10z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 0.75rem center;
            padding-right: 2.5rem;
        }

        .mood-select:focus {
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(91, 95, 234, 0.1);
        }

        .mood-preview {
            margin-top: 1rem;
            padding: 1rem;
            background: #000000;
            border-radius: 8px;
            font-family: 'VT323', 'Courier New', monospace;
            font-size: 1.25rem;
            transition: all 0.3s ease;
        }

        .mood-preview-text {
            display: inline-block;
        }

        .mood-preview.stable {
            color: #34ff35;
            text-shadow: 0 0 8px rgba(52, 255, 53, 0.6);
        }

        .mood-preview.glitchy {
            color: #34ff35;
            text-shadow: 0 0 8px rgba(52, 255, 53, 0.6);
            animation: glitchPreview 0.5s infinite;
        }

        .mood-preview.urgent {
            color: #ff3434;
            text-shadow: 0 0 8px rgba(255, 52, 52, 0.6);
        }

        @keyframes glitchPreview {
            0% { transform: translate(0); filter: hue-rotate(0deg); }
            20% { transform: translate(-2px, 1px); filter: hue-rotate(90deg); }
            40% { transform: translate(1px, -1px); filter: hue-rotate(180deg); }
            60% { transform: translate(-1px, 0); filter: hue-rotate(270deg); }
            80% { transform: translate(2px, 1px); filter: hue-rotate(360deg); }
            100% { transform: translate(0); filter: hue-rotate(0deg); }
        }

        /* Secret Commands Section */
        .secret-commands-section {
            background: white;
            border: 1px solid var(--off-white-dark);
            border-radius: 16px;
            padding: 1.5rem;
            margin-bottom: 2rem;
        }

        .secret-commands-section h2 {
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--primary);
        }

        .secret-commands-section > p {
            font-size: 0.9rem;
            color: rgba(31, 31, 31, 0.6);
            margin-bottom: 1.5rem;
        }

        .secret-commands-list {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .secret-command-card {
            background: var(--background);
            border: 1px solid var(--off-white-dark);
            border-radius: 12px;
            padding: 1.25rem;
            transition: box-shadow 0.2s ease, border-color 0.2s ease;
        }

        .secret-command-card:hover {
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.06);
            border-color: var(--accent);
        }

        .secret-command-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .secret-command-keyword {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .keyword-badge {
            background: linear-gradient(135deg, #1F1F1F, #2a2a2a);
            color: #34ff35;
            font-family: 'VT323', monospace;
            font-size: 1.25rem;
            padding: 0.5rem 1rem;
            border-radius: 6px;
            letter-spacing: 0.1em;
            text-shadow: 0 0 8px rgba(52, 255, 53, 0.4);
            box-shadow: inset 0 0 10px rgba(52, 255, 53, 0.1);
        }

        .secret-command-controls {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .secret-command-body {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 1rem;
        }

        .secret-command-body .form-group {
            margin-bottom: 0;
        }

        .secret-command-body label {
            display: block;
            font-size: 0.75rem;
            font-weight: 500;
            color: rgba(31, 31, 31, 0.6);
            margin-bottom: 0.5rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .secret-command-body input,
        .secret-command-body select {
            width: 100%;
            padding: 0.6rem;
            font-family: 'Inter', system-ui, sans-serif;
            font-size: 0.9rem;
            color: var(--primary);
            background: white;
            border: 1px solid var(--off-white-dark);
            border-radius: 6px;
            outline: none;
            transition: border-color 0.2s ease, box-shadow 0.2s ease;
        }

        .secret-command-body input:focus,
        .secret-command-body select:focus {
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(91, 95, 234, 0.1);
        }

        .secret-command-body .url-field {
            grid-column: span 2;
        }

        @media (max-width: 600px) {
            .secret-command-body .url-field {
                grid-column: span 1;
            }
        }

        .delete-command-btn {
            background: transparent;
            border: 1px solid var(--error);
            color: var(--error);
            padding: 0.4rem 0.75rem;
            border-radius: 4px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .delete-command-btn:hover {
            background: var(--error);
            color: white;
        }

        .add-command-btn {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            background: transparent;
            border: 2px dashed var(--accent);
            color: var(--accent);
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            font-size: 0.95rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .add-command-btn:hover {
            background: rgba(91, 95, 234, 0.1);
            border-style: solid;
        }

        .add-command-btn svg {
            width: 18px;
            height: 18px;
        }

        /* Builders Media Section Input Styles */
        .typing-speed-section .nav-links-grid input,
        .typing-speed-section .nav-links-grid select {
            width: 100%;
            padding: 0.75rem;
            font-family: 'Inter', system-ui, sans-serif;
            font-size: 1rem;
            color: var(--primary);
            background: var(--background);
            border: 1px solid var(--off-white-dark);
            border-radius: 8px;
            outline: none;
            transition: border-color 0.2s ease, box-shadow 0.2s ease;
        }

        .typing-speed-section .nav-links-grid input:focus,
        .typing-speed-section .nav-links-grid select:focus {
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(91, 95, 234, 0.1);
        }

        .typing-speed-section .nav-links-grid label {
            display: block;
            font-size: 0.8rem;
            font-weight: 500;
            color: rgba(31, 31, 31, 0.6);
            margin-bottom: 0.5rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header {
                padding: 1rem 1.5rem;
                flex-wrap: wrap;
                gap: 1rem;
            }

            .nav-links {
                gap: 1rem;
            }

            .login-card {
                padding: 2rem;
            }

            .dashboard {
                padding: 1.5rem;
            }

            .dashboard-header {
                flex-direction: column;
                gap: 1rem;
                align-items: flex-start;
            }

            .dashboard-header h1 {
                font-size: 1.5rem;
            }

            .thoughts-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="logo">ImagineCraft Studios</div>
        <nav>
            <ul class="nav-links">
                <li><a href="main.html">Main Site</a></li>
                <li><a href="index.html">Explore</a></li>
            </ul>
        </nav>
        <button class="logout-btn" id="logoutBtn" onclick="logout()">Logout</button>
    </header>

    <!-- Login Section -->
    <div class="login-container" id="loginContainer">
        <div class="login-card">
            <h1>Admin Dashboard</h1>
            <p>Enter your password to manage thoughts and responses.</p>
            <form id="loginForm" onsubmit="handleLogin(event)">
                <div class="form-group">
                    <label for="password">Password</label>
                    <input type="password" id="password" placeholder="Enter admin password" required>
                    <p class="error-message" id="loginError">Incorrect password. Please try again.</p>
                </div>
                <button type="submit" class="btn btn-primary">Sign In</button>
            </form>
        </div>
    </div>

    <!-- Dashboard Section -->
    <div class="dashboard" id="dashboard">
        <div class="dashboard-header">
            <h1>Manage Thoughts & Responses</h1>
            <div class="dashboard-actions">
                <button class="btn btn-success" onclick="saveChanges()">Save Changes</button>
                <button class="btn btn-primary" onclick="downloadConfig()">Download Config</button>
                <button class="btn btn-danger" onclick="factoryReset()">Factory Reset</button>
            </div>
        </div>
        <!-- Hero Text Section -->
        <div class="hero-section">
            <h2>Hero Heading</h2>
            <p>This is the main static heading displayed at the top. It does not cycle like the thoughts.</p>
            <input type="text" id="heroText" placeholder="Enter hero heading..." value="WHY ARE YOU HERE?">
        </div>

        <!-- Typing Speed Section -->
        <div class="typing-speed-section">
            <h2>Typing Animation Speed</h2>
            <p>Adjust the base speed for typing animations. Lower values = faster typing. The animation maintains a natural, stuttered rhythm.</p>
            <div class="slider-container">
                <div class="slider-labels">
                    <span>Fast</span>
                    <span>Slow</span>
                </div>
                <input type="range" id="typingSpeedSlider" min="50" max="300" value="150" class="speed-slider">
                <div class="slider-value">
                    <span id="typingSpeedValue">150</span>ms base delay
                </div>
            </div>
        </div>

        <!-- Enable Choice Buttons Section -->
        <div class="typing-speed-section">
            <h2>Enable Choice Buttons</h2>
            <p>When enabled, Yes/No buttons appear after each thought finishes typing. "Yes" shows the response, "No" skips to the next thought. When disabled, thoughts auto-cycle after a linger period.</p>
            <div class="toggle-container">
                <label class="toggle-switch">
                    <input type="checkbox" id="choiceButtonsToggle">
                    <span class="toggle-slider"></span>
                </label>
                <span class="toggle-label" id="choiceButtonsToggleLabel">Disabled</span>
            </div>
        </div>

        <!-- Matrix Fade Duration Section -->
        <div class="typing-speed-section">
            <h2>Matrix Fade Duration</h2>
            <p>Adjust how long the Matrix rain animation takes to fade out. This controls the cinematic disappearance effect.</p>
            <div class="slider-container">
                <div class="slider-labels">
                    <span>Quick (0.5s)</span>
                    <span>Slow (5s)</span>
                </div>
                <input type="range" id="matrixFadeSlider" min="0.5" max="5" step="0.1" value="1.5" class="speed-slider">
                <div class="slider-value">
                    <span id="matrixFadeValue">1.5</span>s fade duration
                </div>
            </div>
        </div>

        <!-- Earthquake Duration Section -->
        <div class="typing-speed-section">
            <h2>Earthquake Duration</h2>
            <p>Adjust how many seconds the screen shakes before the terminal splits and reveals the main site. Longer durations create more dramatic tension.</p>
            <div class="slider-container">
                <div class="slider-labels">
                    <span>Quick (0.5s)</span>
                    <span>Long (5s)</span>
                </div>
                <input type="range" id="earthquakeDurationSlider" min="0.5" max="5" step="0.1" value="1.5" class="speed-slider">
                <div class="slider-value">
                    <span id="earthquakeDurationValue">1.5</span>s shake duration
                </div>
            </div>
        </div>

        <!-- Earthquake Transition Section -->
        <div class="typing-speed-section">
            <h2>Earthquake Transition</h2>
            <p>When enabled, clicking "Enter Main Site" will trigger a dramatic earthquake shake and screen crack effect before navigating to the main site.</p>
            <div class="toggle-container">
                <label class="toggle-switch">
                    <input type="checkbox" id="earthquakeToggle" checked>
                    <span class="toggle-slider"></span>
                </label>
                <span class="toggle-label" id="earthquakeToggleLabel">Enabled</span>
            </div>
        </div>

        <!-- Boot Sequence Section -->
        <div class="typing-speed-section">
            <h2>Enable Boot Sequence</h2>
            <p>When enabled, the site will display a "Power Up" boot sequence with system diagnostics and a progress bar on first load. The sequence only plays once per browser session.</p>
            <div class="toggle-container">
                <label class="toggle-switch">
                    <input type="checkbox" id="bootSequenceToggle" checked>
                    <span class="toggle-slider"></span>
                </label>
                <span class="toggle-label" id="bootSequenceToggleLabel">Enabled</span>
            </div>
        </div>

        <!-- AI System Mood Section -->
        <div class="typing-speed-section">
            <h2>AI System Mood</h2>
            <p>Change the visual aesthetic of the terminal. Each mood affects text color, animations, and typing rhythm.</p>
            <div class="mood-selector-container">
                <select id="systemMoodSelect" class="mood-select">
                    <option value="stable">Stable (Default) - Solid green, steady rhythm</option>
                    <option value="glitchy">Glitchy - Flickering text, irregular typing</option>
                    <option value="urgent">Urgent - High-alert red, fast typing</option>
                </select>
                <div class="mood-preview" id="moodPreview">
                    <span class="mood-preview-text">Preview text appearance</span>
                </div>
            </div>
        </div>

        <!-- Builders Media Section (for TRANSPARENT command) -->
        <div class="typing-speed-section">
            <h2>Builders Image/Video URL</h2>
            <p>Set the image or video URL shown behind the terminal when the TRANSPARENT command is triggered. This creates the illusion of builders constructing the site behind the screen.</p>
            <div class="nav-links-grid">
                <div class="form-group">
                    <label>Media Type</label>
                    <select id="buildersMediaType" class="mood-select" style="max-width: 200px;">
                        <option value="image">Image</option>
                        <option value="video">Video (MP4)</option>
                    </select>
                </div>
                <div class="form-group" style="grid-column: span 2;">
                    <label>Media URL</label>
                    <input type="url" id="buildersMediaUrl" placeholder="https://example.com/construction-crew.jpg (or .mp4)">
                </div>
            </div>
            <p style="font-size: 0.85rem; color: rgba(31, 31, 31, 0.5); margin-top: 0.5rem;">
                Tip: For best results, use an image or video of a construction crew with hammers and tools. If left blank, a placeholder animation will be shown.
            </p>
        </div>

        <!-- Managed Secret Commands Section -->
        <div class="secret-commands-section">
            <h2>Managed Secret Commands</h2>
            <p>Configure hidden keywords that trigger special actions when typed anywhere on the terminal. Users can type these keywords to activate hidden features.</p>

            <div class="secret-commands-list" id="secretCommandsList">
                <!-- Command cards will be generated by JavaScript -->
            </div>

            <button type="button" class="add-command-btn" onclick="addNewSecretCommand()">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
                </svg>
                Add New Command
            </button>
        </div>

        <!-- Questions Section with Randomize Toggle -->
        <div class="questions-header-section">
            <h2 style="font-size: 1.25rem; font-weight: 600; margin-bottom: 0; color: var(--primary);">Cycling Thoughts & Responses</h2>
            <div class="randomize-toggle-container">
                <input type="checkbox" id="randomizeToggle" class="randomize-checkbox">
                <label for="randomizeToggle" class="randomize-label">Randomize Active Questions</label>
                <span class="randomize-hint">(When enabled, shows 3 random active questions instead of all)</span>
            </div>
        </div>
        <div class="thoughts-grid" id="thoughtsGrid">
            <!-- Cards will be generated by JavaScript -->
        </div>

        <button type="button" class="add-command-btn" onclick="addNewThought()" style="margin-top: 1.5rem;">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
            </svg>
            Add New Thought
        </button>
    </div>

    <!-- Toast Notification -->
    <div class="toast" id="toast">
        <span id="toastMessage">Changes saved successfully!</span>
    </div>

    <script>
        // Remote configuration (loaded from config.json)
        let remoteConfig = null;

        // Fallback hardcoded defaults (used if config.json fetch fails)
        const fallbackThoughts = [
            "I have ideas.",
            "I don't know where to start.",
            "Our tools don't fit us.",
            "I want software that matches how we work.",
            "Help us think this through.",
            "Who are you?",
            "I need something custom.",
            "Our budget is limited.",
            "We've tried this before.",
            "How long will it take?",
            "Can you work with our team?",
            "What makes you different?"
        ];

        const fallbackResponses = [
            "Starting is the hardest part. We will figure out the first step together.",
            "Who we are is less important than what we can build together.",
            "The right tools don't exist yet; we have to invent them.",
            "Complexity is the enemy. We specialize in radical simplicity.",
            "Your vision is the blueprint. Our code is the foundation.",
            "We're builders who believe software should feel inevitable.",
            "Custom is our specialty. Every solution we build is tailored.",
            "Great work doesn't require a fortune. Let's find what's possible.",
            "Past failures are lessons. We learn what didn't work and build better.",
            "Quality takes time, but we move with purpose. Let's set expectations.",
            "Collaboration is core to how we work. Your team becomes ours.",
            "We listen first. Then we build what actually matters to you."
        ];

        const fallbackHeroText = 'WHY ARE YOU HERE?';

        // Helper functions to get defaults (from remote config or fallback)
        function getDefaultThoughts() {
            return remoteConfig && remoteConfig.thoughts ? [...remoteConfig.thoughts] : [...fallbackThoughts];
        }
        function getDefaultResponses() {
            return remoteConfig && remoteConfig.responses ? [...remoteConfig.responses] : [...fallbackResponses];
        }
        function getDefaultHeroText() {
            return remoteConfig && remoteConfig.heroText ? remoteConfig.heroText : fallbackHeroText;
        }
        function getDefaultActions() {
            if (remoteConfig && remoteConfig.actions) {
                return remoteConfig.actions.map(a => ({...a}));
            }
            return Array(12).fill(null).map(() => ({ type: 'none', url: '', logo: '', linkText: 'Click here' }));
        }
        function getDefaultActiveStates() {
            return remoteConfig && remoteConfig.activeStates ? [...remoteConfig.activeStates] : Array(12).fill(true);
        }
        function getDefaultSettings() {
            if (remoteConfig && remoteConfig.settings) {
                return remoteConfig.settings;
            }
            return {
                typingSpeed: 150,
                choiceButtonsEnabled: false,
                matrixFadeDuration: 1.5,
                earthquakeDuration: 1.5,
                earthquakeEnabled: true,
                bootSequenceEnabled: true,
                randomizeEnabled: false,
                systemMood: 'stable'
            };
        }
        function getDefaultSecretCommands() {
            if (remoteConfig && remoteConfig.secretCommands) {
                return remoteConfig.secretCommands.map(cmd => ({...cmd}));
            }
            return [
                { keyword: 'FOREST', action: 'earthquake', enabled: true, description: 'Triggers Earthquake & Split to reveal background' },
                { keyword: 'MATRIX', action: 'matrix', enabled: true, description: 'Toggles digital rain animation on/off' },
                { keyword: 'ADMIN', action: 'redirect', url: 'admin.html', enabled: true, description: 'Navigates to Admin Dashboard' },
                { keyword: 'WARP', action: 'warp', enabled: true, description: 'Star Wars style hyperspace jump to a distant galaxy' },
                { keyword: 'TRANSPARENT', action: 'transparent', enabled: true, description: 'Fades terminal to reveal the builders behind the screen' }
            ];
        }
        function getDefaultBuildersMedia() {
            return remoteConfig && remoteConfig.buildersMedia ? {...remoteConfig.buildersMedia} : { type: 'image', url: '' };
        }

        // Fetch remote configuration with cache busting
        async function fetchRemoteConfig() {
            try {
                const response = await fetch('config.json?v=' + Date.now());
                if (!response.ok) {
                    throw new Error('Failed to fetch config.json: ' + response.status);
                }
                remoteConfig = await response.json();
                console.log('Remote config loaded successfully');
            } catch (e) {
                console.warn('Failed to load remote config, using fallback defaults:', e);
                remoteConfig = null;
            }
        }

        // App version - must match index.html. Increment to force localStorage data refresh
        const APP_VERSION = '1.0.6';
        const DATA_VERSION_KEY = 'imaginecraft_app_version';

        // Check and handle data version mismatch
        function checkDataVersion() {
            try {
                const storedVersion = localStorage.getItem(DATA_VERSION_KEY);
                if (storedVersion !== APP_VERSION) {
                    console.log('App version mismatch. Stored:', storedVersion, 'Current:', APP_VERSION);
                    console.log('Clearing cached data to load fresh defaults...');
                    // Clear all imaginecraft data keys
                    const keysToRemove = [
                        'imaginecraft_thoughts',
                        'imaginecraft_responses',
                        'imaginecraft_hero_text',
                        'imaginecraft_actions',
                        'imaginecraft_active_states',
                        'imaginecraft_randomize_enabled',
                        'imaginecraft_typing_speed',
                        'imaginecraft_choice_buttons_enabled',
                        'imaginecraft_matrix_fade_duration',
                        'imaginecraft_earthquake_duration',
                        'imaginecraft_earthquake_enabled',
                        'imaginecraft_boot_sequence_enabled',
                        'imaginecraft_system_mood',
                        'imaginecraft_secret_commands',
                        'imaginecraft_builders_media'
                    ];
                    keysToRemove.forEach(function(key) {
                        localStorage.removeItem(key);
                    });
                    // Set new version
                    localStorage.setItem(DATA_VERSION_KEY, APP_VERSION);
                    return true; // Data was cleared
                }
                return false; // Version matched, no clear needed
            } catch (e) {
                console.warn('Failed to check data version:', e);
                return false;
            }
        }

        // Initialize the app after fetching remote config
        async function initializeWithRemoteConfig() {
            await fetchRemoteConfig();
            checkDataVersion();
        }

        // Start fetching config immediately
        const configPromise = initializeWithRemoteConfig();

        // Hardcoded password
        const ADMIN_PASSWORD = 'admin123';

        // Action types
        const ACTION_TYPES = [
            { value: 'none', label: 'None' },
            { value: 'video', label: 'Video' },
            { value: 'image', label: 'Static Image' },
            { value: 'logo', label: 'Logo' },
            { value: 'matrix', label: 'The Matrix' },
            { value: 'contact', label: 'Contact Us Form' }
        ];

        // Secret command action types
        const SECRET_ACTION_TYPES = [
            { value: 'earthquake', label: 'Trigger Earthquake & Split' },
            { value: 'matrix', label: 'Toggle Matrix Animation' },
            { value: 'warp', label: 'Star Wars Hyperspace Jump' },
            { value: 'transparent', label: 'Transparent (Reveal Builders)' },
            { value: 'redirect', label: 'Redirect to URL' }
        ];

        // Current data (will be initialized after config loads)
        let currentThoughts = [];
        let currentResponses = [];
        let currentHeroText = '';
        let currentActions = [];
        let currentActiveStates = [];
        let currentRandomizeEnabled = false;
        let currentTypingSpeed = 150;
        let currentChoiceButtonsEnabled = false;
        let currentMatrixFadeDuration = 1.5;
        let currentEarthquakeDuration = 1.5;
        let currentEarthquakeEnabled = true;
        let currentBootSequenceEnabled = true;
        let currentSystemMood = 'stable';
        let currentSecretCommands = [];
        let currentBuildersMedia = { type: 'image', url: '' };

        // Initialize default actions
        function initDefaultActions() {
            return getDefaultActions();
        }

        // Load data from localStorage
        function loadFromStorage() {
            const defaults = getDefaultSettings();
            try {
                const storedThoughts = localStorage.getItem('imaginecraft_thoughts');
                const storedResponses = localStorage.getItem('imaginecraft_responses');
                const storedHeroText = localStorage.getItem('imaginecraft_hero_text');
                const storedActions = localStorage.getItem('imaginecraft_actions');
                const storedActiveStates = localStorage.getItem('imaginecraft_active_states');
                const storedRandomizeEnabled = localStorage.getItem('imaginecraft_randomize_enabled');
                const storedTypingSpeed = localStorage.getItem('imaginecraft_typing_speed');
                const storedChoiceButtonsEnabled = localStorage.getItem('imaginecraft_choice_buttons_enabled');
                const storedMatrixFadeDuration = localStorage.getItem('imaginecraft_matrix_fade_duration');
                const storedEarthquakeDuration = localStorage.getItem('imaginecraft_earthquake_duration');
                const storedEarthquakeEnabled = localStorage.getItem('imaginecraft_earthquake_enabled');
                const storedBootSequenceEnabled = localStorage.getItem('imaginecraft_boot_sequence_enabled');
                const storedSystemMood = localStorage.getItem('imaginecraft_system_mood');
                const storedSecretCommands = localStorage.getItem('imaginecraft_secret_commands');
                const storedBuildersMedia = localStorage.getItem('imaginecraft_builders_media');

                currentThoughts = storedThoughts ? JSON.parse(storedThoughts) : getDefaultThoughts();
                currentResponses = storedResponses ? JSON.parse(storedResponses) : getDefaultResponses();
                currentHeroText = storedHeroText || getDefaultHeroText();
                currentActions = storedActions ? JSON.parse(storedActions) : initDefaultActions();
                currentActiveStates = storedActiveStates ? JSON.parse(storedActiveStates) : getDefaultActiveStates();
                currentRandomizeEnabled = storedRandomizeEnabled === 'true' ? true : (storedRandomizeEnabled === null ? (defaults.randomizeEnabled || false) : false);
                currentTypingSpeed = storedTypingSpeed ? parseInt(storedTypingSpeed, 10) : (defaults.typingSpeed || 150);
                currentChoiceButtonsEnabled = storedChoiceButtonsEnabled === 'true' ? true : (storedChoiceButtonsEnabled === null ? (defaults.choiceButtonsEnabled || false) : false);
                currentMatrixFadeDuration = storedMatrixFadeDuration ? parseFloat(storedMatrixFadeDuration) : (defaults.matrixFadeDuration || 1.5);
                currentEarthquakeDuration = storedEarthquakeDuration ? parseFloat(storedEarthquakeDuration) : (defaults.earthquakeDuration || 1.5);
                currentEarthquakeEnabled = storedEarthquakeEnabled !== null ? storedEarthquakeEnabled === 'true' : (defaults.earthquakeEnabled !== undefined ? defaults.earthquakeEnabled : true);
                currentBootSequenceEnabled = storedBootSequenceEnabled !== null ? storedBootSequenceEnabled === 'true' : (defaults.bootSequenceEnabled !== undefined ? defaults.bootSequenceEnabled : true);
                currentSystemMood = storedSystemMood || (defaults.systemMood || 'stable');
                currentSecretCommands = storedSecretCommands ? JSON.parse(storedSecretCommands) : getDefaultSecretCommands();
                currentBuildersMedia = storedBuildersMedia ? JSON.parse(storedBuildersMedia) : getDefaultBuildersMedia();

                // Ensure all actions exist (based on thought count)
                const thoughtCount = currentThoughts.length;
                while (currentActions.length < thoughtCount) {
                    currentActions.push({ type: 'none', url: '', logo: '', linkText: 'Click here' });
                }
                // Ensure all active states exist (default to true)
                while (currentActiveStates.length < thoughtCount) {
                    currentActiveStates.push(true);
                }
            } catch (e) {
                console.warn('Failed to load from localStorage:', e);
                currentThoughts = getDefaultThoughts();
                currentResponses = getDefaultResponses();
                currentHeroText = getDefaultHeroText();
                currentActions = initDefaultActions();
                currentActiveStates = getDefaultActiveStates();
                currentRandomizeEnabled = defaults.randomizeEnabled || false;
                currentTypingSpeed = defaults.typingSpeed || 150;
                currentChoiceButtonsEnabled = defaults.choiceButtonsEnabled || false;
                currentMatrixFadeDuration = defaults.matrixFadeDuration || 1.5;
                currentEarthquakeDuration = defaults.earthquakeDuration || 1.5;
                currentEarthquakeEnabled = defaults.earthquakeEnabled !== undefined ? defaults.earthquakeEnabled : true;
                currentBootSequenceEnabled = defaults.bootSequenceEnabled !== undefined ? defaults.bootSequenceEnabled : true;
                currentSystemMood = defaults.systemMood || 'stable';
                currentSecretCommands = getDefaultSecretCommands();
                currentBuildersMedia = getDefaultBuildersMedia();
            }
        }

        // Save data to localStorage
        function saveToStorage() {
            try {
                localStorage.setItem('imaginecraft_thoughts', JSON.stringify(currentThoughts));
                localStorage.setItem('imaginecraft_responses', JSON.stringify(currentResponses));
                localStorage.setItem('imaginecraft_hero_text', currentHeroText);
                localStorage.setItem('imaginecraft_actions', JSON.stringify(currentActions));
                localStorage.setItem('imaginecraft_active_states', JSON.stringify(currentActiveStates));
                localStorage.setItem('imaginecraft_randomize_enabled', currentRandomizeEnabled.toString());
                localStorage.setItem('imaginecraft_typing_speed', currentTypingSpeed.toString());
                localStorage.setItem('imaginecraft_choice_buttons_enabled', currentChoiceButtonsEnabled.toString());
                localStorage.setItem('imaginecraft_matrix_fade_duration', currentMatrixFadeDuration.toString());
                localStorage.setItem('imaginecraft_earthquake_duration', currentEarthquakeDuration.toString());
                localStorage.setItem('imaginecraft_earthquake_enabled', currentEarthquakeEnabled.toString());
                localStorage.setItem('imaginecraft_boot_sequence_enabled', currentBootSequenceEnabled.toString());
                localStorage.setItem('imaginecraft_system_mood', currentSystemMood);
                localStorage.setItem('imaginecraft_secret_commands', JSON.stringify(currentSecretCommands));
                localStorage.setItem('imaginecraft_builders_media', JSON.stringify(currentBuildersMedia));
                return true;
            } catch (e) {
                console.error('Failed to save to localStorage:', e);
                return false;
            }
        }

        // Handle login
        function handleLogin(event) {
            event.preventDefault();
            const password = document.getElementById('password').value;
            const errorEl = document.getElementById('loginError');

            if (password === ADMIN_PASSWORD) {
                errorEl.classList.remove('visible');
                document.getElementById('loginContainer').style.display = 'none';
                document.getElementById('dashboard').classList.add('visible');
                document.getElementById('logoutBtn').classList.add('visible');
                sessionStorage.setItem('admin_authenticated', 'true');
                renderDashboard();
            } else {
                errorEl.classList.add('visible');
            }
        }

        // Logout
        function logout() {
            sessionStorage.removeItem('admin_authenticated');
            document.getElementById('dashboard').classList.remove('visible');
            document.getElementById('logoutBtn').classList.remove('visible');
            document.getElementById('loginContainer').style.display = 'flex';
            document.getElementById('password').value = '';
        }

        // Check if already authenticated
        function checkAuth() {
            if (sessionStorage.getItem('admin_authenticated') === 'true') {
                document.getElementById('loginContainer').style.display = 'none';
                document.getElementById('dashboard').classList.add('visible');
                document.getElementById('logoutBtn').classList.add('visible');
                renderDashboard();
            }
        }

        // Render full dashboard
        function renderDashboard() {
            // Update hero text field
            const heroInput = document.getElementById('heroText');
            if (heroInput) {
                heroInput.value = currentHeroText;
            }

            // Update typing speed slider
            const typingSpeedSlider = document.getElementById('typingSpeedSlider');
            const typingSpeedValue = document.getElementById('typingSpeedValue');
            if (typingSpeedSlider && typingSpeedValue) {
                typingSpeedSlider.value = currentTypingSpeed;
                typingSpeedValue.textContent = currentTypingSpeed;

                // Add event listener for real-time value update
                typingSpeedSlider.addEventListener('input', function() {
                    typingSpeedValue.textContent = this.value;
                });
            }

            // Update choice buttons toggle
            const choiceButtonsToggle = document.getElementById('choiceButtonsToggle');
            const choiceButtonsToggleLabel = document.getElementById('choiceButtonsToggleLabel');
            if (choiceButtonsToggle && choiceButtonsToggleLabel) {
                choiceButtonsToggle.checked = currentChoiceButtonsEnabled;
                choiceButtonsToggleLabel.textContent = currentChoiceButtonsEnabled ? 'Enabled' : 'Disabled';

                // Add event listener for real-time label update
                choiceButtonsToggle.addEventListener('change', function() {
                    choiceButtonsToggleLabel.textContent = this.checked ? 'Enabled' : 'Disabled';
                });
            }

            // Update matrix fade duration slider
            const matrixFadeSlider = document.getElementById('matrixFadeSlider');
            const matrixFadeValue = document.getElementById('matrixFadeValue');
            if (matrixFadeSlider && matrixFadeValue) {
                matrixFadeSlider.value = currentMatrixFadeDuration;
                matrixFadeValue.textContent = currentMatrixFadeDuration;

                // Add event listener for real-time value update
                matrixFadeSlider.addEventListener('input', function() {
                    matrixFadeValue.textContent = this.value;
                });
            }

            // Update earthquake duration slider
            const earthquakeDurationSlider = document.getElementById('earthquakeDurationSlider');
            const earthquakeDurationValue = document.getElementById('earthquakeDurationValue');
            if (earthquakeDurationSlider && earthquakeDurationValue) {
                earthquakeDurationSlider.value = currentEarthquakeDuration;
                earthquakeDurationValue.textContent = currentEarthquakeDuration;

                // Add event listener for real-time value update
                earthquakeDurationSlider.addEventListener('input', function() {
                    earthquakeDurationValue.textContent = this.value;
                });
            }

            // Update earthquake toggle
            const earthquakeToggle = document.getElementById('earthquakeToggle');
            const earthquakeToggleLabel = document.getElementById('earthquakeToggleLabel');
            if (earthquakeToggle && earthquakeToggleLabel) {
                earthquakeToggle.checked = currentEarthquakeEnabled;
                earthquakeToggleLabel.textContent = currentEarthquakeEnabled ? 'Enabled' : 'Disabled';

                // Add event listener for real-time label update
                earthquakeToggle.addEventListener('change', function() {
                    earthquakeToggleLabel.textContent = this.checked ? 'Enabled' : 'Disabled';
                });
            }

            // Update randomize toggle
            const randomizeToggle = document.getElementById('randomizeToggle');
            if (randomizeToggle) {
                randomizeToggle.checked = currentRandomizeEnabled;
            }

            // Update boot sequence toggle
            const bootSequenceToggle = document.getElementById('bootSequenceToggle');
            const bootSequenceToggleLabel = document.getElementById('bootSequenceToggleLabel');
            if (bootSequenceToggle && bootSequenceToggleLabel) {
                bootSequenceToggle.checked = currentBootSequenceEnabled;
                bootSequenceToggleLabel.textContent = currentBootSequenceEnabled ? 'Enabled' : 'Disabled';

                // Add event listener for real-time label update
                bootSequenceToggle.addEventListener('change', function() {
                    bootSequenceToggleLabel.textContent = this.checked ? 'Enabled' : 'Disabled';
                });
            }

            // Update system mood selector
            const systemMoodSelect = document.getElementById('systemMoodSelect');
            const moodPreview = document.getElementById('moodPreview');
            if (systemMoodSelect && moodPreview) {
                systemMoodSelect.value = currentSystemMood;
                updateMoodPreview(currentSystemMood);

                // Add event listener for real-time preview update
                systemMoodSelect.addEventListener('change', function() {
                    updateMoodPreview(this.value);
                });
            }

            // Update builders media fields
            const buildersMediaType = document.getElementById('buildersMediaType');
            const buildersMediaUrl = document.getElementById('buildersMediaUrl');
            if (buildersMediaType && buildersMediaUrl) {
                buildersMediaType.value = currentBuildersMedia.type || 'image';
                buildersMediaUrl.value = currentBuildersMedia.url || '';
            }

            renderThoughtCards();
            renderSecretCommands();
        }

        // Render secret commands list
        function renderSecretCommands() {
            const list = document.getElementById('secretCommandsList');
            if (!list) return;

            list.innerHTML = '';

            currentSecretCommands.forEach((command, index) => {
                const card = document.createElement('div');
                card.className = 'secret-command-card';
                card.id = `secret-command-${index}`;

                const showUrlField = command.action === 'redirect';

                card.innerHTML = `
                    <div class="secret-command-header">
                        <div class="secret-command-keyword">
                            <span class="keyword-badge">${escapeHtml(command.keyword)}</span>
                        </div>
                        <div class="secret-command-controls">
                            <div class="active-toggle-container">
                                <input type="checkbox" id="cmd-enabled-${index}" class="active-checkbox" ${command.enabled ? 'checked' : ''} onchange="handleCommandEnabledChange(${index})">
                                <label for="cmd-enabled-${index}" class="active-label">Enabled</label>
                            </div>
                            <button type="button" class="delete-command-btn" onclick="deleteSecretCommand(${index})">Delete</button>
                        </div>
                    </div>
                    <div class="secret-command-body">
                        <div class="form-group">
                            <label>Keyword</label>
                            <input type="text" id="cmd-keyword-${index}" value="${escapeHtml(command.keyword)}" placeholder="e.g., FOREST" onchange="updateCommandKeyword(${index})" style="text-transform: uppercase;">
                        </div>
                        <div class="form-group">
                            <label>Action Type</label>
                            <select id="cmd-action-${index}" onchange="handleCommandActionChange(${index})">
                                ${SECRET_ACTION_TYPES.map(type => `
                                    <option value="${type.value}" ${command.action === type.value ? 'selected' : ''}>
                                        ${type.label}
                                    </option>
                                `).join('')}
                            </select>
                        </div>
                        <div class="form-group url-field" id="cmd-url-group-${index}" style="${showUrlField ? '' : 'display: none;'}">
                            <label>Redirect URL</label>
                            <input type="text" id="cmd-url-${index}" value="${escapeHtml(command.url || '')}" placeholder="e.g., admin.html or https://..." onchange="updateCommandUrl(${index})">
                        </div>
                        <div class="form-group" style="grid-column: ${showUrlField ? '1' : '1 / -1'};">
                            <label>Description (optional)</label>
                            <input type="text" id="cmd-desc-${index}" value="${escapeHtml(command.description || '')}" placeholder="Describe what this command does" onchange="updateCommandDescription(${index})">
                        </div>
                    </div>
                `;

                list.appendChild(card);
            });
        }

        // Handle command enabled checkbox change
        function handleCommandEnabledChange(index) {
            const checkbox = document.getElementById(`cmd-enabled-${index}`);
            if (checkbox) {
                currentSecretCommands[index].enabled = checkbox.checked;
            }
        }

        // Handle command action type change
        function handleCommandActionChange(index) {
            const select = document.getElementById(`cmd-action-${index}`);
            const urlGroup = document.getElementById(`cmd-url-group-${index}`);

            if (select) {
                currentSecretCommands[index].action = select.value;

                // Show/hide URL field based on action type
                if (urlGroup) {
                    urlGroup.style.display = select.value === 'redirect' ? '' : 'none';
                }

                // Update the keyword badge display
                const keywordInput = document.getElementById(`cmd-keyword-${index}`);
                if (keywordInput) {
                    const badge = document.querySelector(`#secret-command-${index} .keyword-badge`);
                    if (badge) {
                        badge.textContent = keywordInput.value.toUpperCase();
                    }
                }
            }
        }

        // Update command keyword
        function updateCommandKeyword(index) {
            const input = document.getElementById(`cmd-keyword-${index}`);
            if (input) {
                const keyword = input.value.toUpperCase().replace(/[^A-Z0-9]/g, '');
                input.value = keyword;
                currentSecretCommands[index].keyword = keyword;

                // Update the badge
                const badge = document.querySelector(`#secret-command-${index} .keyword-badge`);
                if (badge) {
                    badge.textContent = keyword;
                }
            }
        }

        // Update command URL
        function updateCommandUrl(index) {
            const input = document.getElementById(`cmd-url-${index}`);
            if (input) {
                currentSecretCommands[index].url = input.value;
            }
        }

        // Update command description
        function updateCommandDescription(index) {
            const input = document.getElementById(`cmd-desc-${index}`);
            if (input) {
                currentSecretCommands[index].description = input.value;
            }
        }

        // Add new secret command
        function addNewSecretCommand() {
            const newCommand = {
                keyword: 'NEWCMD',
                action: 'redirect',
                url: '',
                enabled: true,
                description: ''
            };

            currentSecretCommands.push(newCommand);
            renderSecretCommands();

            // Scroll to new command and focus keyword input
            setTimeout(() => {
                const newIndex = currentSecretCommands.length - 1;
                const newCard = document.getElementById(`secret-command-${newIndex}`);
                if (newCard) {
                    newCard.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    const keywordInput = document.getElementById(`cmd-keyword-${newIndex}`);
                    if (keywordInput) {
                        keywordInput.focus();
                        keywordInput.select();
                    }
                }
            }, 100);
        }

        // Delete secret command
        function deleteSecretCommand(index) {
            if (confirm('Are you sure you want to delete this secret command?')) {
                currentSecretCommands.splice(index, 1);
                renderSecretCommands();
            }
        }

        // Add new thought
        function addNewThought() {
            const newIndex = currentThoughts.length;

            // Add empty thought with defaults
            currentThoughts.push('');
            currentResponses.push('');
            currentActions.push({ type: 'none', url: '', logo: '', linkText: 'Click here' });
            currentActiveStates.push(true);

            renderThoughtCards();

            // Scroll to new thought and focus input
            setTimeout(() => {
                const newCard = document.getElementById(`thought-card-${newIndex}`);
                if (newCard) {
                    newCard.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    const thoughtInput = document.getElementById(`thought-${newIndex}`);
                    if (thoughtInput) {
                        thoughtInput.focus();
                    }
                }
            }, 100);
        }

        // Delete thought
        function deleteThought(index) {
            if (currentThoughts.length <= 1) {
                alert('You must have at least one thought.');
                return;
            }

            if (confirm('Are you sure you want to delete this thought?')) {
                currentThoughts.splice(index, 1);
                currentResponses.splice(index, 1);
                currentActions.splice(index, 1);
                currentActiveStates.splice(index, 1);
                renderThoughtCards();
            }
        }

        // Update mood preview
        function updateMoodPreview(mood) {
            const moodPreview = document.getElementById('moodPreview');
            if (!moodPreview) return;

            // Remove all mood classes
            moodPreview.classList.remove('stable', 'glitchy', 'urgent');

            // Add the selected mood class
            moodPreview.classList.add(mood);
        }

        // Render thought cards
        function renderThoughtCards() {
            const grid = document.getElementById('thoughtsGrid');
            grid.innerHTML = '';

            // Iterate over actual thoughts array length
            const thoughtCount = currentThoughts.length;
            for (let i = 0; i < thoughtCount; i++) {
                const action = currentActions[i] || { type: 'none', url: '', logo: '', linkText: 'Click here' };
                const isActive = currentActiveStates[i] !== false; // Default to true
                const card = document.createElement('div');
                card.className = 'thought-card' + (isActive ? '' : ' inactive');
                card.id = `thought-card-${i}`;
                card.innerHTML = `
                    <div class="card-header">
                        <span class="card-number">${i + 1}</span>
                        <div class="card-controls">
                            <div class="active-toggle-container">
                                <input type="checkbox" id="active-${i}" class="active-checkbox" ${isActive ? 'checked' : ''} onchange="handleActiveChange(${i})">
                                <label for="active-${i}" class="active-label">Active</label>
                            </div>
                            <button type="button" class="delete-command-btn" onclick="deleteThought(${i})">Delete</button>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Thought</label>
                        <input type="text" id="thought-${i}" value="${escapeHtml(currentThoughts[i] || '')}" placeholder="Enter thought...">
                    </div>
                    <div class="form-group">
                        <label>Response</label>
                        <textarea id="response-${i}" placeholder="Enter response...">${escapeHtml(currentResponses[i] || '')}</textarea>
                    </div>
                    <div class="form-group">
                        <label>Action Type</label>
                        <select id="action-type-${i}" onchange="handleActionTypeChange(${i})">
                            ${ACTION_TYPES.map(type => `
                                <option value="${type.value}" ${action.type === type.value ? 'selected' : ''}>
                                    ${type.label}
                                </option>
                            `).join('')}
                        </select>
                    </div>
                    <div id="action-fields-${i}" class="action-fields ${action.type === 'none' ? 'hidden' : ''}">
                        ${renderActionFields(i, action)}
                    </div>
                `;
                grid.appendChild(card);
            }
        }

        // Handle active checkbox change
        function handleActiveChange(index) {
            const checkbox = document.getElementById(`active-${index}`);
            const card = document.getElementById(`thought-card-${index}`);

            if (checkbox && card) {
                const isActive = checkbox.checked;
                currentActiveStates[index] = isActive;

                if (isActive) {
                    card.classList.remove('inactive');
                } else {
                    card.classList.add('inactive');
                }
            }
        }

        // Render action-specific fields
        function renderActionFields(index, action) {
            const linkTextField = `
                <div class="form-group">
                    <label>Link Text (shown in terminal)</label>
                    <input type="text" id="action-linktext-${index}" value="${escapeHtml(action.linkText || 'Click here')}" placeholder="Click here">
                </div>
            `;

            switch (action.type) {
                case 'video':
                    return `
                        ${linkTextField}
                        <div class="form-group">
                            <label>YouTube URL</label>
                            <input type="url" id="action-url-${index}" value="${escapeHtml(action.url || '')}" placeholder="https://www.youtube.com/watch?v=...">
                        </div>
                    `;
                case 'image':
                    return `
                        ${linkTextField}
                        <div class="form-group">
                            <label>Image URL</label>
                            <input type="url" id="action-url-${index}" value="${escapeHtml(action.url || '')}" placeholder="https://example.com/image.jpg">
                        </div>
                    `;
                case 'logo':
                    return `
                        ${linkTextField}
                        <div class="form-group">
                            <label>ASCII Logo</label>
                            <textarea id="action-logo-${index}" placeholder="Enter ASCII art...">${escapeHtml(action.logo || '')}</textarea>
                        </div>
                    `;
                case 'matrix':
                    return linkTextField;
                case 'contact':
                    return linkTextField;
                default:
                    return '';
            }
        }

        // Handle action type change
        function handleActionTypeChange(index) {
            const select = document.getElementById(`action-type-${index}`);
            const fieldsContainer = document.getElementById(`action-fields-${index}`);
            const actionType = select.value;

            // Update current action
            if (!currentActions[index]) {
                currentActions[index] = { type: 'none', url: '', logo: '', linkText: 'Click here' };
            }
            currentActions[index].type = actionType;

            // Show/hide fields container
            if (actionType === 'none') {
                fieldsContainer.classList.add('hidden');
                fieldsContainer.innerHTML = '';
            } else {
                fieldsContainer.classList.remove('hidden');
                fieldsContainer.innerHTML = renderActionFields(index, currentActions[index]);
            }
        }

        // Escape HTML to prevent XSS
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // Save changes
        function saveChanges() {
            // Save hero text
            const heroInput = document.getElementById('heroText');
            if (heroInput) {
                currentHeroText = heroInput.value || defaultHeroText;
            }

            // Save typing speed
            const typingSpeedSlider = document.getElementById('typingSpeedSlider');
            if (typingSpeedSlider) {
                currentTypingSpeed = parseInt(typingSpeedSlider.value, 10) || 150;
            }

            // Save choice buttons setting
            const choiceButtonsToggle = document.getElementById('choiceButtonsToggle');
            if (choiceButtonsToggle) {
                currentChoiceButtonsEnabled = choiceButtonsToggle.checked;
            }

            // Save matrix fade duration
            const matrixFadeSlider = document.getElementById('matrixFadeSlider');
            if (matrixFadeSlider) {
                currentMatrixFadeDuration = parseFloat(matrixFadeSlider.value) || 1.5;
            }

            // Save earthquake duration
            const earthquakeDurationSlider = document.getElementById('earthquakeDurationSlider');
            if (earthquakeDurationSlider) {
                currentEarthquakeDuration = parseFloat(earthquakeDurationSlider.value) || 1.5;
            }

            // Save earthquake transition setting
            const earthquakeToggle = document.getElementById('earthquakeToggle');
            if (earthquakeToggle) {
                currentEarthquakeEnabled = earthquakeToggle.checked;
            }

            // Save randomize setting
            const randomizeToggle = document.getElementById('randomizeToggle');
            if (randomizeToggle) {
                currentRandomizeEnabled = randomizeToggle.checked;
            }

            // Save boot sequence setting
            const bootSequenceToggle = document.getElementById('bootSequenceToggle');
            if (bootSequenceToggle) {
                currentBootSequenceEnabled = bootSequenceToggle.checked;
            }

            // Save system mood setting
            const systemMoodSelect = document.getElementById('systemMoodSelect');
            if (systemMoodSelect) {
                currentSystemMood = systemMoodSelect.value;
            }

            // Save builders media settings
            const buildersMediaType = document.getElementById('buildersMediaType');
            const buildersMediaUrl = document.getElementById('buildersMediaUrl');
            if (buildersMediaType && buildersMediaUrl) {
                currentBuildersMedia = {
                    type: buildersMediaType.value,
                    url: buildersMediaUrl.value
                };
            }

            // Save secret commands
            for (let i = 0; i < currentSecretCommands.length; i++) {
                const keywordInput = document.getElementById(`cmd-keyword-${i}`);
                const actionSelect = document.getElementById(`cmd-action-${i}`);
                const urlInput = document.getElementById(`cmd-url-${i}`);
                const descInput = document.getElementById(`cmd-desc-${i}`);
                const enabledCheckbox = document.getElementById(`cmd-enabled-${i}`);

                if (keywordInput) {
                    currentSecretCommands[i].keyword = keywordInput.value.toUpperCase().replace(/[^A-Z0-9]/g, '');
                }
                if (actionSelect) {
                    currentSecretCommands[i].action = actionSelect.value;
                }
                if (urlInput) {
                    currentSecretCommands[i].url = urlInput.value;
                }
                if (descInput) {
                    currentSecretCommands[i].description = descInput.value;
                }
                if (enabledCheckbox) {
                    currentSecretCommands[i].enabled = enabledCheckbox.checked;
                }
            }

            // Save thoughts, responses, actions, and active states (dynamic count)
            const thoughtCount = currentThoughts.length;
            for (let i = 0; i < thoughtCount; i++) {
                const thoughtInput = document.getElementById(`thought-${i}`);
                const responseInput = document.getElementById(`response-${i}`);

                if (thoughtInput) {
                    currentThoughts[i] = thoughtInput.value;
                }
                if (responseInput) {
                    currentResponses[i] = responseInput.value;
                }

                // Save active state
                const activeCheckbox = document.getElementById(`active-${i}`);
                if (activeCheckbox) {
                    currentActiveStates[i] = activeCheckbox.checked;
                }

                const actionTypeSelect = document.getElementById(`action-type-${i}`);
                const actionType = actionTypeSelect ? actionTypeSelect.value : 'none';
                if (!currentActions[i]) {
                    currentActions[i] = { type: 'none', url: '', logo: '', linkText: 'Click here' };
                }
                currentActions[i].type = actionType;

                // Save action-specific fields
                if (actionType !== 'none') {
                    const linkTextInput = document.getElementById(`action-linktext-${i}`);
                    if (linkTextInput) {
                        currentActions[i].linkText = linkTextInput.value || 'Click here';
                    }

                    if (actionType === 'video' || actionType === 'image') {
                        const urlInput = document.getElementById(`action-url-${i}`);
                        if (urlInput) {
                            currentActions[i].url = urlInput.value;
                        }
                    } else if (actionType === 'logo') {
                        const logoInput = document.getElementById(`action-logo-${i}`);
                        if (logoInput) {
                            currentActions[i].logo = logoInput.value;
                        }
                    }
                }
            }

            if (saveToStorage()) {
                showToast('Changes saved successfully!', 'success');
            } else {
                showToast('Failed to save changes.', 'error');
            }
        }

        // Show toast notification
        function showToast(message, type = 'success') {
            const toast = document.getElementById('toast');
            const toastMessage = document.getElementById('toastMessage');

            toastMessage.textContent = message;
            toast.className = 'toast visible ' + type;

            setTimeout(() => {
                toast.classList.remove('visible');
            }, 3000);
        }

        // Download current configuration as config.json
        function downloadConfig() {
            // Build the config object from current state
            const config = {
                version: APP_VERSION,
                heroText: currentHeroText,
                thoughts: [...currentThoughts],
                responses: [...currentResponses],
                actions: currentActions.map(a => ({...a})),
                activeStates: [...currentActiveStates],
                settings: {
                    typingSpeed: currentTypingSpeed,
                    choiceButtonsEnabled: currentChoiceButtonsEnabled,
                    matrixFadeDuration: currentMatrixFadeDuration,
                    earthquakeDuration: currentEarthquakeDuration,
                    earthquakeEnabled: currentEarthquakeEnabled,
                    bootSequenceEnabled: currentBootSequenceEnabled,
                    randomizeEnabled: currentRandomizeEnabled,
                    systemMood: currentSystemMood
                },
                secretCommands: currentSecretCommands.map(cmd => ({...cmd})),
                buildersMedia: {...currentBuildersMedia}
            };

            // Convert to JSON with pretty formatting
            const jsonString = JSON.stringify(config, null, 2);

            // Create a blob and download link
            const blob = new Blob([jsonString], { type: 'application/json' });
            const url = URL.createObjectURL(blob);

            // Create temporary download link and click it
            const downloadLink = document.createElement('a');
            downloadLink.href = url;
            downloadLink.download = 'config.json';
            document.body.appendChild(downloadLink);
            downloadLink.click();
            document.body.removeChild(downloadLink);

            // Clean up the URL object
            URL.revokeObjectURL(url);

            showToast('Config downloaded! Upload to your GitHub repository to update the site.', 'success');
        }

        // Factory Reset - clears all localStorage and reloads the page
        function factoryReset() {
            if (!confirm('Are you sure you want to reset all settings to factory defaults?\n\nThis will clear all your customizations and cannot be undone.')) {
                return;
            }

            try {
                // Clear all imaginecraft data keys
                const keysToRemove = [
                    'imaginecraft_thoughts',
                    'imaginecraft_responses',
                    'imaginecraft_hero_text',
                    'imaginecraft_actions',
                    'imaginecraft_active_states',
                    'imaginecraft_randomize_enabled',
                    'imaginecraft_typing_speed',
                    'imaginecraft_choice_buttons_enabled',
                    'imaginecraft_matrix_fade_duration',
                    'imaginecraft_earthquake_duration',
                    'imaginecraft_earthquake_enabled',
                    'imaginecraft_boot_sequence_enabled',
                    'imaginecraft_system_mood',
                    'imaginecraft_secret_commands',
                    'imaginecraft_builders_media',
                    'imaginecraft_app_version'
                ];
                keysToRemove.forEach(function(key) {
                    localStorage.removeItem(key);
                });

                showToast('Factory reset complete. Reloading...', 'success');

                // Reload after a brief delay to show the toast
                setTimeout(function() {
                    window.location.reload();
                }, 1000);
            } catch (e) {
                console.error('Factory reset failed:', e);
                showToast('Factory reset failed. Please try again.', 'error');
            }
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', async () => {
            // Wait for remote config to load before initializing
            await configPromise;
            loadFromStorage();
            checkAuth();
        });
    </script>
</body>
</html>
